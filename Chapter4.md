#### 无向图模型

###### 4.1误解示例

重新考虑3.4.2节中关于学生误解的例子。在这个例子中，四个学生聚在一起，通过两两组队来完成某门功课的作业。所有可能的组合在无向图中以边的形式存在。

我们希望对仅仅满足$(A\bot C|\{ B,D \}) $ 和$(B\bot D|\{ A,C \}) $ 而不包括其他独立性条件的分布进行建模。正如所显示的，这两个独立性要求并不能自然地通过一个贝叶斯网络来表示，因为任意一个这样分布的贝叶斯网$I-map$ 都必然要包含额外的边。进而导致所期望的这两个独立性条件中的一个无法得到满足。**贝叶斯网络**要求为每一个影响都指定一个方向，而在本例中，变量之间的交互影响似乎是对称的，因此我们期望能够构建一个不需要强行为影响指定的模型来表示这种相互关系。

实现这种表示的一种方法是无向图模型。这种无向图模型被称为是马尔科夫网，节点代表的是变量，而边则与近邻变量之间的有向概率交互影响的概念相对应。这是一种不受网络中任何其他变量影响的交互影响。

剩余的问题是如何参数化这个无向图。由于图中的交互影响是无向的，所以无法使用在给定其他节点时候在一个节点上表示分布的标准CPD（因为这个节点可能与给定的节点相互影响）

相关变量之间的亲密关系:affinities

**定义4.1** 假定$D$ 表示的是随机变量的集合，因子$\phi$ 定义为从$Val(D)$  映射到实数域$R$ 的一个函数。加入因子的所有表值均非负，那么这个因子被称为是非负的，变量集$D$ 称为因子的辖域，记为$Scopo[\phi]$ 

**通过局部因子相乘来定义分布，并且归一化** 

$P(a,b,c,d) = \frac{1}{Z}  \phi_1(a,b) \cdot \phi_2(b,c)  \cdot \phi_3(c,d)  \cdot \phi_4(d,a) $ 

可以用这个联合分布来计算单一变量的概率。 

**分布的分解与其独立性质之间有着密切的关系:**

*  当$P \models (X \bot Y  |Z)$ 当且仅当$P(\cal X) = \phi_1(X,Z)  \phi_2(Y,Z) $ 

一个因子既包含联合分布的概念，也包括CPD的概念。D上的一个联合分布就是D上的一个因子。因子可以大致可以看成是因子在其辖域不同值之间兼容性的一个描述。

一般可以通过允许将因子定义在任意变量子集上来获得。给出下面关于因子的主要运算：

**定义4.2** 令$X,Y,Z$ 是三个不相交的变量集，且令$\phi_1(X,Y) $ 和$\phi_2(Y,Z) $ 是两个因子。那么因子的乘积$\phi_1 \times \phi_2$定义为如下所示的一个新的因子$\psi : Val(X,Y,Z) \longmapsto  R: $ 

$\psi(X,Y,Z) = \phi_1(X,Y) \cdot \phi_2(Y,Z) $ 

**定义4.4** 假如每个$D_k(k=1,…,K)$ 都是$\cal H$  的完备子图，那么称具有$\phi =  \{ \phi_1(D_1),…,\phi_k(D_k) \} $ 的分布$P_{\phi} $ 在马尔科夫网$\cal H$ 上因子分解

参数化马尔科夫网的因子通常被称为团位势

##### 简化的马尔科夫网

在分布上取条件，与在联合分布中消去所有与事件$U=u$ 不一致的表值，以及将剩余的表值重新归一化相对应。

**定义4.5** 令$\phi (Y) $ 为一个因子，且$U=u$ 为$U \subseteq Y$ 的一个赋值，因子$\phi$ 关于上下文$U=u$ 的约简定义为辖域$Y'=Y-U$ 上的一个因子，记为$\phi[U=u] $ 使得$\phi[u] (y') = \phi(y',u) $ 

令$P_{\phi}(X) $ 为一个吉布斯分布，则$P_{\phi} [u] = P_{\phi} (W|u) $ ，其中$W=X-U$ 

 





